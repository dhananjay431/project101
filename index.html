<!doctype html>
<html ng-app="todoApp">
  <head>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.7.2/angular.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/validate.js/0.12.0/validate.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment.min.js"></script>
    <script>
  angular.module('todoApp', [])
  .controller('TodoListController', function() {



validate.extend(validate.validators.datetime, {
  // The value is guaranteed not to be null or undefined but otherwise it
  // could be anything.
  parse: function(value, options) {
    return +moment.utc(value);
  },
  // Input is a unix timestamp
  format: function(value, options) {
    var format = options.dateOnly ? "YYYY-MM-DD" : "YYYY-MM-DD hh:mm:ss";
    console.log("format =",format,"=",value );
    return moment.utc(value).format(format);
  }
});
    var todoList = this;
    todoList.data ={username:'',password:'',date:''};
    todoList.msg={};
    todoList.constraints = {
  username: {
    presence: true,
format: {
      pattern: /^([0-9]).*$/,
      message: function(value, attribute, validatorOptions, attributes, globalOptions) {

        return /[a-zA-Z]/.test(value)?'char not ':'enter userName';

        // console.log(value);
        // return validate.format("^%{num} is not a valid credit card number", {
        //   num: value
        //});
      }
    },
    length: function(value, attributes, attributeName, options, constraints) {
      if (value) {
        // Amex
        if ((/[0-9]/).test(value)) return {is: 6};
      }
      // Unknown card, don't validate length
      return false;
    }

  },
  password: {
    presence: true,
    length: {
      minimum: 6,
      message: "must be at least 6 characters"
    }
  },
  date:{
    datetime: {
          dateOnly: true,
          latest: moment.utc().subtract(18, 'years'),
          message: "^You need to be atleast 18 years old"
        }
    }
};

  todoList.show=function(d){
  //  console.log(todoList.data);
    todoList.msg[d] = validate( todoList.data, todoList.constraints)[d];
//    console.log(todoList.msg);

  }
  });
</script>
    
  </head>
  <body>
    <h2>Todo</h2>
    <div ng-controller="TodoListController as todoList">
    <input type="text" ng-model="todoList.data.username" ng-change="todoList.show('username')">
    <ul><li ng-repeat="d in todoList.msg.username">{{d}}</li></ul>
    <input type="text" ng-model="todoList.data.password" ng-change="todoList.show('password')">
    <ul><li ng-repeat="d in todoList.msg.password">{{d}}</li></ul>
    <input type="text" ng-model="todoList.data.date" ng-change="todoList.show('date')">
    <ul><li ng-repeat="d in todoList.msg.date">{{d}}</li></ul>
    <pre>
    </pre>
    </div>
  </body>
</html>

<!-- 
Copyright 2018 Google Inc. All Rights Reserved.
Use of this source code is governed by an MIT-style license that
can be found in the LICENSE file at https://angular.io/license
-->